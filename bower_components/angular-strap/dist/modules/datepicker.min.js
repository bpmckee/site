/**
 * angular-strap
 * @version v2.0.0-rc.2 - 2014-02-01
 * @link http://mgcrea.github.io/angular-strap
 * @author [object Object]
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.datepicker",["mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.popover"]).provider("$datepicker",function(){var a=this.defaults={animation:"am-fade",prefixClass:"datepicker",placement:"bottom",template:"datepicker/datepicker.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,useNative:!1,dateType:"date",dateFormat:"shortDate",autoclose:!1,minDate:-1/0,maxDate:+1/0,startView:0,minView:0,weekStart:0};this.$get=["$window","$document","$rootScope","$sce","$locale","dateFilter","datepickerViews","$popover",function(b,c,d,e,f,g,h,i){function j(b,c,d){function e(a){a.selected=g.$isSelected(a.date)}function f(){b[0].focus()}var g=i(b,angular.extend({},a,d)),j=d.scope,m=g.$options,n=g.$scope,o=h(g);g.$views=o.views;var p=o.viewDate;n.$mode=m.startView;var q=g.$views[n.$mode];n.$select=function(a){g.select(a)},n.$selectPane=function(a){g.$selectPane(a)},n.$toggleMode=function(){g.setMode((n.$mode+1)%g.$views.length)},g.update=function(a){isNaN(a.getTime())?q.built||g.$build():(g.$date=a,q.update.call(q,a))},g.select=function(a,b){angular.isDate(a)||(a=new Date(a)),c.$dateValue.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),!n.$mode||b?(c.$setViewValue(c.$dateValue),c.$render(),m.autoclose&&!b&&g.hide(!0)):(angular.extend(p,{year:a.getFullYear(),month:a.getMonth(),date:a.getDate()}),g.setMode(n.$mode-1),g.$build())},g.setMode=function(a){n.$mode=a,q=g.$views[n.$mode],g.$build()},g.$build=function(){q.build.call(q)},g.$updateSelected=function(){for(var a=0,b=n.rows.length;b>a;a++)angular.forEach(n.rows[a],e)},g.$isSelected=function(a){return q.isSelected(a)},g.$selectPane=function(a){var b=q.steps,c=new Date(Date.UTC(p.year+(b.year||0)*a,p.month+(b.month||0)*a,p.date+(b.day||0)*a));angular.extend(p,{year:c.getUTCFullYear(),month:c.getUTCMonth(),date:c.getUTCDate()}),g.$build()},g.$onMouseDown=function(a){if(a.preventDefault(),a.stopPropagation(),k){var b=angular.element(a.target);"button"!==b[0].nodeName.toLowerCase()&&(b=b.parent()),b.triggerHandler("click")}},g.$onKeyDown=function(a){if(/(38|37|39|40|13)/.test(a.keyCode)&&!a.shiftKey&&!a.altKey){if(a.preventDefault(),a.stopPropagation(),13===a.keyCode)return n.$mode?n.$apply(function(){g.setMode(n.$mode-1)}):g.hide(!0);q.onKeyDown(a),j.$digest()}};var r=g.init;g.init=function(){return l&&m.useNative?(b.prop("type","date"),void b.css("-webkit-appearance","textfield")):(k&&(b.prop("type","text"),b.attr("readonly","true"),b.on("click",f)),void r())};var s=g.destroy;g.destroy=function(){l&&m.useNative&&b.off("click",f),s()};var t=g.show;g.show=function(){t(),setTimeout(function(){g.$element.on(k?"touchstart":"mousedown",g.$onMouseDown),m.keyboard&&b.on("keydown",g.$onKeyDown)})};var u=g.hide;return g.hide=function(a){g.$element.off(k?"touchstart":"mousedown",g.$onMouseDown),m.keyboard&&b.off("keydown",g.$onKeyDown),u(a)},g}var k=(angular.element(b.document.body),"createTouch"in b.document),l=/(iP(a|o)d|iPhone)/g.test(b.navigator.userAgent);return a.lang||(a.lang=f.id),j.defaults=a,j}]}).directive("bsDatepicker",["$window","$parse","$q","$locale","dateFilter","$datepicker","$dateParser","$timeout",function(a,b,c,d,e,f,g){{var h=/(iP(a|o)d|iPhone)/g.test(a.navigator.userAgent);a.requestAnimationFrame||a.setTimeout}return{restrict:"EAC",require:"ngModel",link:function(a,b,c,d){var i={scope:a,controller:d};angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","autoclose","dateType","dateFormat","useNative","lang"],function(a){angular.isDefined(c[a])&&(i[a]=c[a])}),h&&i.useNative&&(i.dateFormat="yyyy-MM-dd");var j=f(b,d,i);i=j.$options,angular.forEach(["minDate","maxDate"],function(a){angular.isDefined(c[a])&&c.$observe(a,function(b){if("today"===b){var c=new Date;j.$options[a]=+new Date(c.getFullYear(),c.getMonth(),c.getDate()+("maxDate"===a?1:0),0,0,0,"minDate"===a?0:-1)}else j.$options[a]=angular.isString(b)&&b.match(/^".+"$/)?+new Date(b.substr(1,b.length-2)):+new Date(b);!isNaN(j.$options[a])&&j.$build()})}),a.$watch(c.ngModel,function(){j.update(d.$dateValue)},!0);var k=g({format:i.dateFormat,lang:i.lang});d.$parsers.unshift(function(a){var b=k.parse(a,d.$dateValue);if(!b||isNaN(b.getTime()))d.$setValidity("date",!1);else{var c=b.getTime()>=i.minDate&&b.getTime()<=i.maxDate;d.$setValidity("date",c),c&&(d.$dateValue=b)}return d.$dateValue=b,"string"===i.dateType?e(a,i.dateFormat):"number"===i.dateType?d.$dateValue.getTime():"iso"===i.dateType?d.$dateValue.toISOString():d.$dateValue}),d.$formatters.push(function(a){var b=angular.isDate(a)?a:new Date(a);return d.$dateValue=b,d.$dateValue}),d.$render=function(){b.val(isNaN(d.$dateValue.getTime())?"":e(d.$dateValue,i.dateFormat))},a.$on("$destroy",function(){j.destroy(),i=null,j=null})}}}]).provider("datepickerViews",function(){function a(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c}this.defaults={dayFormat:"dd",daySplit:7};this.$get=["$locale","$sce","dateFilter",function(b,c,d){return function(c){var e=c.$scope,f=c.$options,g=b.DATETIME_FORMATS.SHORTDAY,h=g.slice(f.weekStart).concat(g.slice(0,f.weekStart)),i=c.$date||new Date,j={year:i.getFullYear(),month:i.getMonth(),date:i.getDate()},k=(6e4*i.getTimezoneOffset(),[{format:"d",split:7,steps:{month:1},update:function(a,b){!this.built||b||a.getFullYear()!==j.year||a.getMonth()!==j.month?(angular.extend(j,{year:c.$date.getFullYear(),month:c.$date.getMonth(),date:c.$date.getDate()}),c.$build()):a.getDate()!==j.date&&(j.date=c.$date.getDate(),c.$updateSelected())},build:function(){for(var b,g=new Date(j.year,j.month,1),i=new Date(+g-864e5*(g.getDay()-f.weekStart)),k=[],l=0;35>l;l++)b=new Date(i.getFullYear(),i.getMonth(),i.getDate()+l),k.push({date:b,label:d(b,this.format),selected:c.$date&&this.isSelected(b),muted:b.getMonth()!==j.month,disabled:this.isDisabled(b)});e.title=d(g,"MMMM yyyy"),e.labels=h,e.rows=a(k,this.split),this.built=!0},isSelected:function(a){return c.$date&&a.getFullYear()===c.$date.getFullYear()&&a.getMonth()===c.$date.getMonth()&&a.getDate()===c.$date.getDate()},isDisabled:function(a){return a.getTime()<f.minDate||a.getTime()>f.maxDate},onKeyDown:function(a){var b=c.$date.getTime();37===a.keyCode?c.select(new Date(b-864e5),!0):38===a.keyCode?c.select(new Date(b-6048e5),!0):39===a.keyCode?c.select(new Date(b+864e5),!0):40===a.keyCode&&c.select(new Date(b+6048e5),!0)}},{name:"month",format:"MMM",split:4,steps:{year:1},update:function(a){this.built&&a.getFullYear()===j.year?a.getMonth()!==j.month&&(angular.extend(j,{month:c.$date.getMonth(),date:c.$date.getDate()}),c.$updateSelected()):(angular.extend(j,{year:c.$date.getFullYear(),month:c.$date.getMonth(),date:c.$date.getDate()}),c.$build())},build:function(){for(var b,f=(new Date(j.year,0,1),[]),g=0;12>g;g++)b=new Date(j.year,g,1),f.push({date:b,label:d(b,this.format),selected:c.$isSelected(b),disabled:this.isDisabled(b)});e.title=d(b,"yyyy"),e.labels=!1,e.rows=a(f,this.split),this.built=!0},isSelected:function(a){return c.$date&&a.getFullYear()===c.$date.getFullYear()&&a.getMonth()===c.$date.getMonth()},isDisabled:function(a){var b=+new Date(a.getFullYear(),a.getMonth()+1,0);return b<f.minDate||a.getTime()>f.maxDate},onKeyDown:function(a){var b=c.$date.getMonth();37===a.keyCode?c.select(c.$date.setMonth(b-1),!0):38===a.keyCode?c.select(c.$date.setMonth(b-4),!0):39===a.keyCode?c.select(c.$date.setMonth(b+1),!0):40===a.keyCode&&c.select(c.$date.setMonth(b+4),!0)}},{name:"year",format:"yyyy",split:4,steps:{year:12},update:function(a,b){!this.built||b||parseInt(a.getFullYear()/20,10)!==parseInt(j.year/20,10)?(angular.extend(j,{year:c.$date.getFullYear(),month:c.$date.getMonth(),date:c.$date.getDate()}),c.$build()):a.getFullYear()!==j.year&&(angular.extend(j,{year:c.$date.getFullYear(),month:c.$date.getMonth(),date:c.$date.getDate()}),c.$updateSelected())},build:function(){for(var b,f=j.year-j.year%(3*this.split),g=[],h=0;12>h;h++)b=new Date(f+h,0,1),g.push({date:b,label:d(b,this.format),selected:c.$isSelected(b),disabled:this.isDisabled(b)});e.title=g[0].label+"-"+g[g.length-1].label,e.labels=!1,e.rows=a(g,this.split),this.built=!0},isSelected:function(a){return c.$date&&a.getFullYear()===c.$date.getFullYear()},isDisabled:function(a){var b=+new Date(a.getFullYear()+1,0,0);return b<f.minDate||a.getTime()>f.maxDate},onKeyDown:function(a){var b=c.$date.getFullYear();37===a.keyCode?c.select(c.$date.setYear(b-1),!0):38===a.keyCode?c.select(c.$date.setYear(b-4),!0):39===a.keyCode?c.select(c.$date.setYear(b+1),!0):40===a.keyCode&&c.select(c.$date.setYear(b+4),!0)}}]);return{views:f.minView?Array.prototype.slice.call(k,f.minView):k,viewDate:j}}}]}),angular.module("mgcrea.ngStrap.datepicker").run(["$templateCache",function(a){a.put("datepicker/datepicker.tpl.html",'<div class="popover datepicker" ng-class="\'datepicker-mode-\' + $mode"><div class="arrow"></div><div class="controls"><button type="button" tabindex="-1" ng-click="$selectPane(-1)"><i class="fa fa-chevron-left"></i></button> <button type="button" tabindex="-1" ng-click="$toggleMode()"><span ng-bind="title"></span></button> <button type="button" tabindex="-1" ng-click="$selectPane(+1)"><i class="fa fa-chevron-right"></i></button></div><div class="table" ng-class="{showLabels: labels}"><div class="labels table-row" ng-show="labels"><span ng-repeat="label in labels">{{ label }}</span></div><div class="table-row" ng-repeat="(i,row) in rows" height="{{ 100/rows.length }}%"><div ng-repeat="(j,el) in row"><button type="button" tabindex="-1" ng-class="{\'selected\': el.selected, \'muted\':el.muted}" ng-click="$select(el.date)" ng-disabled="el.disabled">{{ el.label }}</button></div></div></div></div>')}]);
//# sourceMappingURL=datepicker.min.map